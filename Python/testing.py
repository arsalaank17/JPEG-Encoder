import numpy as np
from scipy.fftpack import idct
from PIL import Image

# 'frequency_data' is the 8x8 frequency data obtained from the DCT
y_frequency_data = [[1215, 5, -55, 0, 5, -41, -2, 70],
                    [73, 3, -7, -29, -54, 12, -19, 2],
                    [-100, -18, -58, 34, 50, 30, 57, -77],
                    [26, 11, -12, 26, 14, 1, 9, -33],
                    [-117, 6, 136, -44, -3, -20, -42, 77],
                    [-33, -10, 6, -4, -3, -8, 5, 18],
                    [17, 4, 2, 18, -5, 11, -23, -35],
                    [35, 0, -14, 1, -15, 6, 4, -12]]

cb_frequency_data = [[1159, -1, 46, 6, 0, -4, -19, 0],
                     [39, 9, 12, -5, 0, 3, -5, -1],
                     [56, -1, 22, 5, 0, -3, -9, 0],
                     [17, -13, -21, -7, 0, 4, 8, 2],
                     [0, 0, 0, 0, 0, 0, 0, 0],
                     [-11, 9, 14, 4, 0, -3, -5, -1],
                     [-23, 0, -9, -2, 0, 1, 3, 0],
                     [-7, -1, -2, 1, 0, 0, 0, 0]]

cr_frequency_data = [[1006, 19, -125, -36, 0, 24, 52, -3],
                     [-236, -41, -28, 34, 0, -22, 11, 8],
                     [-147, 8, -68, -21, 0, 14, 28, -1],
                     [-25, 40, 40, 23, 0, -15, -16, -7],
                     [0, 0, 0, 0, 0, 0, 0, 0],
                     [17, -26, -27, -15, 0, 10, 11, 5],
                     [61, -3, 28, 9, 0, -6, -11, 0],
                     [47, 8, 5, -6, 0, 4, -2, -1]]

# original
y = [[134.5218505859375, 134.5218505859375, 139.1917877197265625, 138.9037933349609375, 139.202789306640625,
      138.3058013916015625, 134.5218505859375, 134.8208465576171875],
     [135.119842529296875, 143.77972412109375, 195.1760406494140625, 202.3729400634765625, 199.9599761962890625,
      197.88800048828125, 143.491729736328125, 135.1088409423828125],
     [138.2947998046875, 192.013092041015625, 205.3319091796875, 193.4840850830078125, 203.722930908203125,
      194.6800689697265625, 193.18707275390625, 141.98675537109375],
     [137.4218292236328125, 177.96234130859375, 187.2391815185546875, 47.05828857421875, 172.1244049072265625,
      47.8302764892578125, 186.940185546875, 174.1804046630859375],
     [169.0064849853515625, 199.68499755859375, 189.254150390625, 103.8904266357421875, 183.8232269287109375,
      103.4774322509765625, 187.379180908203125, 172.0774383544921875],
     [167.615509033203125, 163.9155731201171875, 148.878814697265625, 195.1620635986328125, 207.3418731689453125,
      197.646026611328125, 140.4149322509765625, 135.7318572998046875],
     [130.959930419921875, 94.6756439208984375, 152.878753662109375, 169.0784912109375, 198.0850067138671875,
      188.3161773681640625, 95.1486358642578125, 127.968963623046875],
     [129.2569427490234375, 84.914794921875, 94.47967529296875, 100.04156494140625, 133.3419036865234375,
      92.4696807861328125, 92.4876861572265625, 131.34991455078125]]

# original
cb = [[171.72442626953125, 171.72442626953125, 168.52471923828125, 168.6872406005859375, 168.5185089111328125,
       169.0247039794921875, 171.72442626953125, 171.555694580078125],
      [171.386962890625, 166.4999542236328125, 134.109588623046875, 131.741180419921875, 131.409881591796875,
       134.27215576171875, 166.6624755859375, 171.3931732177734375],
      [169.030914306640625, 134.7658538818359375, 126.6853485107421875, 126.035064697265625, 127.0290069580078125,
       125.360137939453125, 134.1033477783203125, 165.8187713623046875],
      [166.137542724609375, 131.9727020263671875, 127.8662261962890625, 132.4820709228515625, 129.0595703125,
       131.482086181640625, 128.0349578857421875, 131.2852783203125],
      [131.947723388671875, 128.179046630859375, 132.3724517822265625, 167.0014495849609375, 136.5659332275390625,
       166.6701812744140625, 132.8662109375, 130.7790374755859375],
      [131.6040191650390625, 129.7416534423828125, 129.1979522705078125, 131.8601226806640625, 128.37274169921875,
       131.0226898193359375, 133.4100189208984375, 165.9625701904296875],
      [166.962493896484375, 140.0345611572265625, 129.1980133056640625, 129.085418701171875, 131.9036407470703125,
       127.8227691650390625, 139.20330810546875, 170.3433837890625],
      [170.180877685546875, 141.0281982421875, 129.4228057861328125, 134.1847686767578125, 163.9252777099609375,
       139.0221099853515625, 134.497283935546875, 168.999755859375]]

# original
cr = [[32.05169677734375, 32.05169677734375, 40.13299560546875, 41.0516815185546875, 41.5516815185546875,
       40.0516815185546875, 32.05169677734375, 32.55169677734375],
      [33.05169677734375, 46.1330108642578125, 140.7142333984375, 149.132965087890625, 148.7142333984375,
       141.632965087890625, 47.05169677734375, 31.6330108642578125],
      [38.63299560546875, 142.9702606201171875, 162.7141876220703125, 159.03924560546875, 160.2954864501953125,
       161.03924560546875, 142.1328887939453125, 49.5516510009765625],
      [52.807647705078125, 172.2502593994140625, 159.2139434814453125, 131.5250701904296875, 152.876373291015625,
       131.68768310546875, 158.7139434814453125, 177.087554931640625],
      [177.92486572265625, 163.888885498046875, 157.0635833740234375, 121.6601409912109375, 150.2383575439453125,
       121.2414398193359375, 158.40093994140625, 178.5875091552734375],
      [180.3435211181640625, 187.2621002197265625, 197.2739715576171875, 159.9823455810546875, 157.714263916015625,
       161.0636749267578125, 186.1926422119140625, 54.7263031005859375],
      [54.563629150390625, 194.5658416748046875, 197.2740325927734375, 185.006103515625, 150.0515899658203125,
       169.1447601318359375, 194.22845458984375, 43.144989013671875],
      [42.226318359375, 195.82177734375, 221.8094940185546875, 199.2975921630859375, 63.5635833740234375,
       197.5657806396484375, 203.97222900390625, 45.726318359375]]

# subsampled
sub_cb = [[170.3339385986328125, 170.3339385986328125, 150.7656707763671875, 150.7656707763671875, 150.806304931640625,
           150.806304931640625, 170.3339385986328125, 170.3339385986328125],
          [170.3339385986328125, 170.3339385986328125, 150.7656707763671875, 150.7656707763671875, 150.806304931640625,
           150.806304931640625, 170.3339385986328125, 170.3339385986328125],
          [150.47674560546875, 150.47674560546875, 128.2671661376953125, 128.2671661376953125, 128.232696533203125,
           128.232696533203125, 139.810577392578125, 139.810577392578125],
          [150.47674560546875, 150.47674560546875, 128.2671661376953125, 128.2671661376953125, 128.232696533203125,
           128.232696533203125, 139.810577392578125, 139.810577392578125],
          [130.36810302734375, 130.36810302734375, 140.1079864501953125, 140.1079864501953125, 140.6578826904296875,
           140.6578826904296875, 140.75445556640625, 140.75445556640625],
          [130.36810302734375, 130.36810302734375, 140.1079864501953125, 140.1079864501953125, 140.6578826904296875,
           140.6578826904296875, 140.75445556640625, 140.75445556640625],
          [154.5515289306640625, 154.5515289306640625, 130.472747802734375, 130.472747802734375, 140.6684417724609375,
           140.6684417724609375, 153.26092529296875, 153.26092529296875],
          [154.5515289306640625, 154.5515289306640625, 130.472747802734375, 130.472747802734375, 140.6684417724609375,
           140.6684417724609375, 153.26092529296875, 153.26092529296875]]

# subsampled
sub_cr = [
    [35.822021484375, 35.822021484375, 92.757965087890625, 92.757965087890625, 92.987640380859375, 92.987640380859375,
     35.822021484375, 35.822021484375],
    [35.822021484375, 35.822021484375, 92.757965087890625, 92.757965087890625, 92.987640380859375, 92.987640380859375,
     35.822021484375, 35.822021484375],
    [101.665283203125, 101.665283203125, 153.12310791015625, 153.12310791015625, 151.4746856689453125,
     151.4746856689453125, 131.8715057373046875, 131.8715057373046875],
    [101.665283203125, 101.665283203125, 153.12310791015625, 153.12310791015625, 151.4746856689453125,
     151.4746856689453125, 131.8715057373046875, 131.8715057373046875],
    [177.3548431396484375, 177.3548431396484375, 158.9950103759765625, 158.9950103759765625, 147.564422607421875,
     147.564422607421875, 144.476837158203125, 144.476837158203125],
    [177.3548431396484375, 177.3548431396484375, 158.9950103759765625, 158.9950103759765625, 147.564422607421875,
     147.564422607421875, 144.476837158203125, 144.476837158203125],
    [121.7943878173828125, 121.7943878173828125, 200.8468017578125, 200.8468017578125, 145.0814208984375,
     145.0814208984375, 121.7679901123046875, 121.7679901123046875],
    [121.7943878173828125, 121.7943878173828125, 200.8468017578125, 200.8468017578125, 145.0814208984375,
     145.0814208984375, 121.7679901123046875, 121.7679901123046875]]
#

# Subsampled data
yy = np.array(y, dtype=np.uint8)
scb = np.array(sub_cb, dtype=np.uint8)
scr = np.array(sub_cr, dtype=np.uint8)

#

# Perform the inverse DCT on the frequency data
y_intensity_data = idct(idct(y_frequency_data, axis=0, norm='ortho'), axis=1, norm='ortho')
cb_intensity_data = idct(idct(cb_frequency_data, axis=0, norm='ortho'), axis=1, norm='ortho')
cr_intensity_data = idct(idct(cr_frequency_data, axis=0, norm='ortho'), axis=1, norm='ortho')

# Convert the intensity data to integers
y_intensity_data = y_intensity_data.astype(np.uint8)
cb_intensity_data = cb_intensity_data.astype(np.uint8)
cr_intensity_data = cr_intensity_data.astype(np.uint8)

#

# the image after performing Subsampling to the Chrominance chanel
array_sub = np.dstack((yy, scb, scr))

# the image after performing Inverse DCT (conversion of frequency data to intensity data)
array_idct = np.dstack((y_intensity_data, cb_intensity_data, cr_intensity_data))

# Create PIL Image from array
image = Image.fromarray(array_sub)

# Display the image
image.show()

import matplotlib.pyplot as plt

plt.subplot(1, 3, 1)
plt.imshow(yy, cmap='gray')
plt.axis('off')
plt.title('Y Component')

plt.subplot(1, 3, 2)
plt.imshow(scb)
#, cmap='gray'
plt.axis('off')
plt.title('Subsampled data Cb Component')

plt.subplot(1, 3, 3)
plt.imshow(scr)
#, cmap='gray'
plt.axis('off')
plt.title('Subsampled data Cr Component')

plt.show()